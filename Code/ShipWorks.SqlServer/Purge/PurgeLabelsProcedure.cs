using System;
using System.Data;
using System.Data.SqlClient;
using System.Data.SqlTypes;
using Microsoft.SqlServer.Server;
using ShipWorks.SqlServer;
using ShipWorks.SqlServer.Purge;

public partial class StoredProcedures
{
    private const string LabelsPurgeAppLockName = "PurgeLabels";

    /// <summary>
    /// Purges old label records from the database.
    /// This script will remove all non-thermal shipping labels older than a certain date
    /// This is done by adding png and gif resources to ShipWorks that say 'This resource has been deleted'
    /// and then pointing all of the expired labels to this resource while deleting the old ones.
    /// </summary>
    /// <param name="earliestRetentionDate">Indicates the date/time to use for determining
    /// which Label records will be purged. Any records with an Shipment.ProcessedDate value earlier than
    /// this date will be purged.</param>
    /// <param name="latestExecutionTimeInUtc">This indicates the latest date/time (in UTC) that this procedure
    /// is allowed to execute. Passing in a SqlDateTime.MaxValue will effectively let the procedure run until
    /// all the appropriate records have been purged.</param>
    [SqlProcedure]
    public static void PurgeLabels(SqlDateTime earliestRetentionDateInUtc, SqlDateTime latestExecutionTimeInUtc)
    {
        PurgeScriptRunner.RunPurgeScript(PurgeLabelCommandText, LabelsPurgeAppLockName, earliestRetentionDateInUtc, latestExecutionTimeInUtc);
    }

    private static string PurgeLabelCommandText
    {
        get
        {
            return @"
SET NOCOUNT ON

DECLARE 
	@OldCount int,
	@DeletedLabelResourceID_PNG bigint,
	@DeletedLabelResourceID_GIF bigint,
	@DeletedLabelResourceID_JPG bigint,
	@DeletedLabelResourceID_EPL bigint,
	@DeletedLabelResourceID_ZPL bigint,
	@startTime DATETIME = GETUTCDATE(),
    @batchSize INT = 1000,
    @batchTotal BIGINT = 0;

-- insert the Deleted image (png format)
SELECT @OldCount = COUNT(*) FROM [Resource] WHERE [Filename] = '__ResourceCleanup_png.swr'
IF (@OldCount = 0)
BEGIN
	
	INSERT INTO [Resource] ([Data], [Checksum], [Compressed], [Filename])
	VALUES(0x89504E470D0A1A0A0000000D49484452000000E10000002C08020000001CA74847000000017352474200AECE1CE90000000467414D410000B18F0BFC6105000000097048597300000EC300000EC301C76FA8640000040849444154785EED9ACD6D23310C8553488EAE2627D792836B31E0528C949274E043E083612080331AFD9112A9998929ACB078C11E1613F9917CFA86A28CBC3CF00307C676E065ECF4901D1C7880514030BA036074F41D427E60140C8CEE00181D7D87901F180503A33B004647DF21E40746C1C0E80E80D1D17708F981513030BA036074F41D427E60140C8CEE00181D7D87901F180503A33BF00CA35FB7B7DDF53C7A8516F959556AA5B3B1A6F3E1F276FA697EE8FEBEBBBC7F6CD45DB17C45E84595558C5E5F7797F2DFE1FE501D77052F99B298D9480BACD8B2D2D9E8CD0A50D630FA73DC6FE67845E8C56256311A543E4FDFAFFBDB67D2FC478E2FD664BFC0AA522B9D8D15AE00E5FF66F42376D98C2F2DD8BD7CA10753BE2797A70FEE6FC7C3FCDBA92B4F3F6E0BE362FFC4FD480AE24A4E40DE982A907BD942A038ABC8A1630A5E59A8F4214889097B255D47A95DF1A4A11353CE89CD26E7634DAE94335AAFA14F76DFC7AF544EBD5FC49322F4C6572B2E7FB68F5E6267A545E6FF3BA7326D3C47BFE5F9B725D9DE564161F62B0E4F33C119F13C1F334669201737BAFC719DA3C8A173BA7E87C23B4616878F8717494D989D3C498764AE26A024A6E5C302E51A279F23A35AA5F2F6F906113F5B9CF58DDCC4D07F24F4B1E9EFF0DB673D395038A3DABDCAB192912AC5E7E637CD15733F6037B392DAB8B2988F39A38CDDE2B5D142734625FA89ED29AB3A614DC79F24A1467AC82C3D572BA54D94B48664855E29DF322919CF6BBA57B5F64B0AFD6742BB331A1AA13B58E3BB9592AD192D6E66D1A9786C0585C97106593AE21B673DA1BC1ECEC879AD8C259A323DD649AB2E126E313A27A625A026A6E613421516314665938BB6C2AFC861232A4625292DF4D08C86E43891EE61CDA836157889B8BE4B1F6D875698A0FB21CC2475C9C59D89F64B290175525A62B4F8206354AE74CD785631BA22E715D7B5457A9F9D47C51350BA24D657DA620BDD82AAD7D2FC59BF64F3683D6CF90E149E1781EA79747DE8399FE43B61D4955C4EDE75C96C8E24A39E9640EB7973F62035322BD44AC996A96BE86CEA2F73D27EB5426FFEEA6AF6BB33A36E17E389507E452CB799BCDE13262BA42B76F1456C7A7EB86BF328193FD2F5855F9FEB2F77D5BE35A3E92799D3D533DA2A79D2D9DFCEE95B05DA87D8C559B986A7C496FA28ABF1709F3095EFF5F25D4A75A39C61949CF3884243B39BEE62EFA40BB630BA49188BE180910360D4C848C87473008C76B316C2460E8051232321D3CD0130DACD5A081B3900468D8C844C3707C068376B216CE4001835321232DD1C00A3DDAC85B0910360D4C848C87473008C76B316C2460E8051232321D3CD0130DACD5A081B3900468D8C844C3707C068376B216CE4001835321232DD1C00A3DDAC85B0910360D4C848C87473008C76B316C2460EFC026C1C1B4997DFB4730000000049454E44AE426082,
	0x4BC1D33D787336CE644DA23DCFE116FD5A432B876BA8AFABC455B9813941EAD0,
	0,
	'__ResourceCleanup_png.swr');
	
	SET @DeletedLabelResourceID_PNG = @@IDENTITY
END
ELSE
BEGIN
	-- we've run it once, so just locate the resource id we are redirecting to
	SELECT @DeletedLabelResourceID_PNG = ResourceID FROM [Resource] WHERE [Filename] = '__ResourceCleanup_png.swr'
END

-- insert the Deleted image (gif format)
SELECT @OldCount = COUNT(*) FROM [Resource] WHERE [Filename] = '__ResourceCleanup_gif.swr'
IF (@OldCount = 0)
BEGIN
	-- insert the Deleted image (gif format)
	INSERT INTO [Resource] ([Data], [Checksum], [Compressed], [Filename])
	VALUES(0x474946383961E1002C00F700000000000000330000660000990000CC0000FF002B00002B33002B66002B99002BCC002BFF0055000055330055660055990055CC0055FF0080000080330080660080990080CC0080FF00AA0000AA3300AA6600AA9900AACC00AAFF00D50000D53300D56600D59900D5CC00D5FF00FF0000FF3300FF6600FF9900FFCC00FFFF3300003300333300663300993300CC3300FF332B00332B33332B66332B99332BCC332BFF3355003355333355663355993355CC3355FF3380003380333380663380993380CC3380FF33AA0033AA3333AA6633AA9933AACC33AAFF33D50033D53333D56633D59933D5CC33D5FF33FF0033FF3333FF6633FF9933FFCC33FFFF6600006600336600666600996600CC6600FF662B00662B33662B66662B99662BCC662BFF6655006655336655666655996655CC6655FF6680006680336680666680996680CC6680FF66AA0066AA3366AA6666AA9966AACC66AAFF66D50066D53366D56666D59966D5CC66D5FF66FF0066FF3366FF6666FF9966FFCC66FFFF9900009900339900669900999900CC9900FF992B00992B33992B66992B99992BCC992BFF9955009955339955669955999955CC9955FF9980009980339980669980999980CC9980FF99AA0099AA3399AA6699AA9999AACC99AAFF99D50099D53399D56699D59999D5CC99D5FF99FF0099FF3399FF6699FF9999FFCC99FFFFCC0000CC0033CC0066CC0099CC00CCCC00FFCC2B00CC2B33CC2B66CC2B99CC2BCCCC2BFFCC5500CC5533CC5566CC5599CC55CCCC55FFCC8000CC8033CC8066CC8099CC80CCCC80FFCCAA00CCAA33CCAA66CCAA99CCAACCCCAAFFCCD500CCD533CCD566CCD599CCD5CCCCD5FFCCFF00CCFF33CCFF66CCFF99CCFFCCCCFFFFFF0000FF0033FF0066FF0099FF00CCFF00FFFF2B00FF2B33FF2B66FF2B99FF2BCCFF2BFFFF5500FF5533FF5566FF5599FF55CCFF55FFFF8000FF8033FF8066FF8099FF80CCFF80FFFFAA00FFAA33FFAA66FFAA99FFAACCFFAAFFFFD500FFD533FFD566FFD599FFD5CCFFD5FFFFFF00FFFF33FFFF66FFFF99FFFFCCFFFFFF00000000000000000000000021F904010000FC002C00000000E1002C000008FF00F7091C48B0A0C18308132A5CC8B0A1C38710234A9C48B1A2C58B18336ADCC8B1A3C78F20438A1C49B2A4C9932853AA5CC9B2A5CB973063CA9C49B3A6CD9B3873EADCC9B3A7CF9F40830A1D4AB4A8D1A348932A5DCAB4A9D3A750A326D5F7EDDD52AA5629622DC92E9CC272E236760D292DDB346CA9B251DB5AF09B57A16C27C615C9EE96C26FE714AE43F7B0EEC87CD4087A2BC674B045C324C72624E74BA1395C7DDF86CC97AADE406FF4A6BD9A66791FB9B0FBD6A5E53C501F35766AF75145955AA068B39657B7663BD634EAC0F3B2B1B62A3B7041CCD3600BCCBDDBB566D297330B57FD8DB56FE6CE9307473E30DFF1766FA94A7BF51CAC40EDDC057AFFCB866D9A3BE8ADF759DF8C7DE4BCE7FA360B2CD7781FFD7DEF0F5A8735D0FB3EBFF995F60D68ECA8C25C567EE9230D7FAA49C39B57FEF9555A36A9CCD7983E6FAD63578005E943A140EC3018A15DF61168978715DA57DF77D99CA70F2A6F7D539F84DED427A36B24DE27D0377CFD77628BAAC1E85E36CB7CF74D678A95E3553EAF6445507C5951561A674C3A998F812C5A86586D4D82C8E07029AA461D55484A365C60551A44E677D4D4334F98FA7036CF3453D6B3E67F660236503B1B66D3599C9695C3576E7FB6F91F68F3BCF22795CFF1E91E7CDF10E6A378F5CD83D679D52137672A686183E59CAE58C5CE36021643DB89D29449506EA96CB7E0939182FF48E23AC769339C6E4E3227693ED8B869166BA8D89AE834C0DAEAA1A4128218CB4063BD998DAB0CD688DF34AE0417AC65EB546A56B5AE04C6CEB2209AF911659DEDE30D826FF9F75D2A4EEA838DA4F3D88A9082EF5C59276D5E41391C9602E999D0B9E1FE87A5BDA539285856FAA8520FC104F9FB9BAAD53DE7573EF216F4997A1513B40E680E47CC2C8921C5FB2791B20AC418ACE5026A2431F3464A558F1A5A885F367659F727360F52C5F2411E1639E9A83B664C95CFAA65A368686F01FC9BA4A5753969C184E5F6D6BB06DD78AC41E690A87387D2449D4DBEDF40E691753EB3D55E89FF6D868DD8DF852A20B5D378C5CE59A9F4A80FA7A990FA5D79B00083ED2ED3F94893CA34457AF8EC2B7A1B99D5D9E5A0D58E81ECBCB21D68DF81D38E59FCEE838D6ED9806B2EA7D39C78A4406757571635F378EE0DDD6F5D8C9E342406FE0A5F54811EFBE9A98BD7A354BCF7EEFBEFC0072FFCF0C4176FFCF1C827AFFCF2CC37EFFCF3D0472FFDF4D4576FFDF5D867AFFDF6DC77EFFDF7E0872FFEF8D50704003B,
	0xA1349D0C4FBC71040684EDDE8922162CD392D8B5E00EEEC0C86FDA9C37344A5B,
	0,
	'__ResourceCleanup_gif.swr');

	SET @DeletedLabelResourceID_GIF = @@IDENTITY
END
ELSE
BEGIN
	SELECT @DeletedLabelResourceID_GIF = ResourceID FROM [Resource] WHERE [Filename] = '__ResourceCleanup_gif.swr'
END

-- insert the Deleted image (jpg format)
SELECT @OldCount = COUNT(*) FROM [Resource] WHERE [Filename] = '__ResourceCleanup_jpg.swr'
IF (@OldCount = 0)
BEGIN
	-- insert the Deleted image (jpg format)
	INSERT INTO [Resource] ([Data], [Checksum], [Compressed], [Filename])
	VALUES(0x0FFD8FFE000104A46494600010101012C012C0000FFE100684578696600004D4D002A000000080004011A0005000000010000003E011B0005000000010000004601280003000000010002000001310002000000120000004E000000000000012C000000010000012C000000015061696E742E4E45542076332E352E313000FFE20A204943435F50524F46494C4500010100000A1000000000021000006D6E74725247422058595A20000000000000000000000000616373704150504C0000000000000000000000000000000000000000000000000000F6D5000100000000D32C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000A64657363000000FC0000007C63707274000001780000002877747074000001A000000014626B7074000001B4000000147258595A000001C8000000146758595A000001DC000000146258595A000001F00000001472545243000002040000080C67545243000002040000080C62545243000002040000080C6465736300000000000000224172746966657820536F6674776172652073524742204943432050726F66696C650000000000000000000000224172746966657820536F6674776172652073524742204943432050726F66696C65000000000000000000000000000000000000000000000000000000000000000000007465787400000000436F70797269676874204172746966657820536F66747761726520323031310058595A20000000000000F35100010000000116CC58595A200000000000000000000000000000000058595A200000000000006FA2000038F50000039058595A2000000000000062990000B785000018DA58595A2000000000000024A000000F840000B6CF63757276000000000000040000000005000A000F00140019001E00230028002D00320037003B00400045004A004F00540059005E00630068006D00720077007C00810086008B00900095009A009F00A400A900AE00B200B700BC00C100C600CB00D000D500DB00E000E500EB00F000F600FB01010107010D01130119011F0125012B01320138013E0145014C0152015901600167016E0175017C0183018B0192019A01A101A901B101B901C101C901D101D901E101E901F201FA0203020C0214021D0226022F02380241024B0254025D02670271027A0284028E029802A202AC02B602C102CB02D502E002EB02F50300030B03160321032D03380343034F035A03660372037E038A039603A203AE03BA03C703D303E003EC03F9040604130420042D043B0448045504630471047E048C049A04A804B604C404D304E104F004FE050D051C052B053A05490558056705770586059605A605B505C505D505E505F6060606160627063706480659066A067B068C069D06AF06C006D106E306F507070719072B073D074F076107740786079907AC07BF07D207E507F8080B081F08320846085A086E0882089608AA08BE08D208E708FB09100925093A094F09640979098F09A409BA09CF09E509FB0A110A270A3D0A540A6A0A810A980AAE0AC50ADC0AF30B0B0B220B390B510B690B800B980BB00BC80BE10BF90C120C2A0C430C5C0C750C8E0CA70CC00CD90CF30D0D0D260D400D5A0D740D8E0DA90DC30DDE0DF80E130E2E0E490E640E7F0E9B0EB60ED20EEE0F090F250F410F5E0F7A0F960FB30FCF0FEC1009102610431061107E109B10B910D710F511131131114F116D118C11AA11C911E81207122612451264128412A312C312E31303132313431363138313A413C513E5140614271449146A148B14AD14CE14F01512153415561578159B15BD15E0160316261649166C168F16B216D616FA171D17411765178917AE17D217F7181B18401865188A18AF18D518FA19201945196B199119B719DD1A041A2A1A511A771A9E1AC51AEC1B141B3B1B631B8A1BB21BDA1C021C2A1C521C7B1CA31CCC1CF51D1E1D471D701D991DC31DEC1E161E401E6A1E941EBE1EE91F131F3E1F691F941FBF1FEA20152041206C209820C420F0211C2148217521A121CE21FB22272255228222AF22DD230A23382366239423C223F0241F244D247C24AB24DA250925382568259725C725F726272657268726B726E827182749277A27AB27DC280D283F287128A228D429062938296B299D29D02A022A352A682A9B2ACF2B022B362B692B9D2BD12C052C392C6E2CA22CD72D0C2D412D762DAB2DE12E162E4C2E822EB72EEE2F242F5A2F912FC72FFE3035306C30A430DB3112314A318231BA31F2322A3263329B32D4330D3346337F33B833F1342B3465349E34D83513354D358735C235FD3637367236AE36E937243760379C37D738143850388C38C839053942397F39BC39F93A363A743AB23AEF3B2D3B6B3BAA3BE83C273C653CA43CE33D223D613DA13DE03E203E603EA03EE03F213F613FA23FE24023406440A640E74129416A41AC41EE4230427242B542F7433A437D43C044034447448A44CE45124555459A45DE4622466746AB46F04735477B47C04805484B489148D7491D496349A949F04A374A7D4AC44B0C4B534B9A4BE24C2A4C724CBA4D024D4A4D934DDC4E254E6E4EB74F004F494F934FDD5027507150BB51065150519B51E65231527C52C75313535F53AA53F65442548F54DB5528557555C2560F565C56A956F75744579257E0582F587D58CB591A596959B85A075A565AA65AF55B455B955BE55C355C865CD65D275D785DC95E1A5E6C5EBD5F0F5F615FB36005605760AA60FC614F61A261F56249629C62F06343639763EB6440649464E9653D659265E7663D669266E8673D679367E9683F689668EC6943699A69F16A486A9F6AF76B4F6BA76BFF6C576CAF6D086D606DB96E126E6B6EC46F1E6F786FD1702B708670E0713A719571F0724B72A67301735D73B87414747074CC7528758575E1763E769B76F8775677B37811786E78CC792A798979E77A467AA57B047B637BC27C217C817CE17D417DA17E017E627EC27F237F847FE5804780A8810A816B81CD8230829282F4835783BA841D848084E3854785AB860E867286D7873B879F8804886988CE8933899989FE8A648ACA8B308B968BFC8C638CCA8D318D988DFF8E668ECE8F368F9E9006906E90D6913F91A89211927A92E3934D93B69420948A94F4955F95C99634969F970A977597E0984C98B89924999099FC9A689AD59B429BAF9C1C9C899CF79D649DD29E409EAE9F1D9F8B9FFAA069A0D8A147A1B6A226A296A306A376A3E6A456A4C7A538A5A9A61AA68BA6FDA76EA7E0A852A8C4A937A9A9AA1CAA8FAB02AB75ABE9AC5CACD0AD44ADB8AE2DAEA1AF16AF8BB000B075B0EAB160B1D6B24BB2C2B338B3AEB425B49CB513B58AB601B679B6F0B768B7E0B859B8D1B94AB9C2BA3BBAB5BB2EBBA7BC21BC9BBD15BD8FBE0ABE84BEFFBF7ABFF5C070C0ECC167C1E3C25FC2DBC358C3D4C451C4CEC54BC5C8C646C6C3C741C7BFC83DC8BCC93AC9B9CA38CAB7CB36CBB6CC35CCB5CD35CDB5CE36CEB6CF37CFB8D039D0BAD13CD1BED23FD2C1D344D3C6D449D4CBD54ED5D1D655D6D8D75CD7E0D864D8E8D96CD9F1DA76DAFBDB80DC05DC8ADD10DD96DE1CDEA2DF29DFAFE036E0BDE144E1CCE253E2DBE363E3EBE473E4FCE584E60DE696E71FE7A9E832E8BCE946E9D0EA5BEAE5EB70EBFBEC86ED11ED9CEE28EEB4EF40EFCCF058F0E5F172F1FFF28CF319F3A7F434F4C2F550F5DEF66DF6FBF78AF819F8A8F938F9C7FA57FAE7FB77FC07FC98FD29FDBAFE4BFEDCFF6DFFFFFFDB0043000201010201010202020202020202030503030303030604040305070607070706070708090B0908080A0807070A0D0A0A0B0C0C0C0C07090E0F0D0C0E0B0C0C0CFFDB004301020202030303060303060C0807080C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0CFFC000110804B0070803012200021101031101FFC4001F0000010501010101010100000000000000000102030405060708090A0BFFC400B5100002010303020403050504040000017D01020300041105122131410613516107227114328191A1082342B1C11552D1F02433627282090A161718191A25262728292A3435363738393A434445464748494A535455565758595A636465666768696A737475767778797A838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE1E2E3E4E5E6E7E8E9EAF1F2F3F4F5F6F7F8F9FAFFC4001F0100030101010101010101010000000000000102030405060708090A0BFFC400B51100020102040403040705040400010277000102031104052131061241510761711322328108144291A1B1C109233352F0156272D10A162434E125F11718191A262728292A35363738393A434445464748494A535455565758595A636465666768696A737475767778797A82838485868788898A92939495969798999AA2A3A4A5A6A7A8A9AAB2B3B4B5B6B7B8B9BAC2C3C4C5C6C7C8C9CAD2D3D4D5D6D7D8D9DAE2E3E4E5E6E7E8E9EAF2F3F4F5F6F7F8F9FAFFDA000C03010002110311003F00FDFCA28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AF2DFDB2FF006C6F01FEC15FB3CEB7F143E246A53697E13D05A08EE2482DDAE279249A5486348E35E5D8BB8E07400938009AF52AFC17FF0083DCFF0069DBAD37C15F057E0E59CDB6DB56BABCF176AA81B0CDE428B5B4E3BA9335D939EE8BE9401FA3DFB04FFC1767E04FFC14ABE31CDE07F84E7C71ACEAD6564FA8DF4F73E1F96D6CF4F817003CD331C2EE72A8A392CCDC0C0623ECAAFCF9FF00836A7FE09E7A67EC2BFF0004CDF07EA971A7C30F8EBE2C59C1E2CF10DDB2626293A6FB2B627AAAC36EE9F27692498E01635FA0D4010EA5A95BE8DA75C5E5E5C436B696B1B4D3CF3388E3851412CCCC7855001249E0015F0BFC66FF008396BF62CF823E2C9B45BEF8CF61AD5FDBB6D94F87F49BED5ED53E973042D03FFC024623BE2BF34BFE0F0FFF0082A86BD27C51D3BF65FF0006EB175A6E87A5D943ABF8E3ECB298DF51B89D77DAD8C854E7CA484ACCC87E5769E2247EEC57CE9FF04DEFF834EFE327EDD7F01B49F891E24F17683F0A7C3BE26B65BDD0E0BEB19350D4AFEDD802970D02B46B144EA7721690BB0C1D80152403FA2AFD8CFF00E0A85F007FE0A096F3FF00C2A1F89DE1EF175E5AA79B3E9AA64B3D4A04CE0BB5A5C247384CF1BF66DF7E457BE57F22FF00F0517FF8230FED07FF00040DF1FF00847E2CE8BE2C8755D12CB5541A378D7C39E65B4DA55F00CC915CC0F9311915640066489D77231F98A1FE8CBFE0897FF05278BFE0A97FB03786FE225DC76B6BE2ED3E57D0BC576B6E36C50EA702A1778D724AC72C724532A93F28976E4EDC900FADA8A28A0028A28A0028A28A0028A28A00FC71FF008385BFE0E16F8D1FF049AFDB43C31F0E7E1CF863E17EB5A26B5E0AB5F124F3F8934EBEB9BA4B896FAFEDD915A0BC8504612D6320142725BE620803F63ABF981FF83D5BFE529BE01FFB255A77FE9DF58AFE9FA800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AFE627FE0F5AB9BA6FF829CFC3B859A6FB1C7F0BEC9E2539F2C48756D54391DB242C79F60BED5FD3B57E1BFF00C1E8DFB0AEB1F11BE117C3BF8F5A058C97B0F80CCDE1EF12F949B9EDECEE1D64B6B86F48D27F32363EB729DB24007EDBF83ECB4FD37C25A5DBE921174BB7B48A3B309F74421008F1EDB40AD1AFC6FF00F821CFFC1CCDF067C71FB297843E1CFC74F18DAFC3DF88DE09D3A1D18EA7AC074D37C436F0A88A1B81720148E6F2C2091652B9605D490484E83FE0B3DFF07327C0FF00845FB27F8B3C25F053C71A77C47F89DE30D3E7D1ECA6D0D9A4B2D0126468DEF64B9DBE533229631C719662FB490AB96A00FC41F1A4D27FC15CFF00E0BB9791C3236A5A5FC5EF8A82D61911B3B3463782346C8EA23B08C1C8EA23CD7F651A669B6FA369D6F67690C76F6B6B1AC30C51AED4891400AA076000000AFE5EFF00E0CEAFD8E6F3E347FC146753F8AB7760D27877E1068B34915CBA9D9FDA97C8D6D0463B13F676BC7EFB4AA1C64823FA8AA00F96FF00E0B69F0B749F8BFF00F0490FDA2B4CD62DA1BAB6B1F016ADADC2248C3ECB9B0B67BD81C67A32CB6E841EA319AFCB9FF831BBC637D7BE09FDA4BC3F23A9D374CBEF0EEA102739596E23D4A394F5C72B6B176EDDF8C7DA7FF07477ED93A6FECABFF049AF1A686D710FFC249F168AF84749B627E6912521EF24C0E76A5B2CA33D03C9183F7803F387FC193BF056EBC29FB157C58F1E5C5BC90C7E32F16C3A6DB33AE3CF8AC6D41DEA7A95F32EE45CF4CA30EC6803F69A8A28A002BF99DFDBCBFE0E9AFDABBF67BFDB93E337807C3BA9780E3F0FF81FC75ADF87F4C5B8F0EACB32DADA6A13C10877DFF336C8D727B9C9AFE98ABCBFC41FB107C16F166BD7DAAEABF087E17EA7AA6A77125DDE5E5DF856C66B8BB9A462CF248ED1167766258B31249249E6803F997FF88BE7F6C6FF00A0A7C3BFFC2613FF008BA3FE22F9FDB1BFE829F0EFFF000984FF00E2EBFA5CFF008600F80FFF00444FE11FFE11FA7FFF0019A3FE1803E03FFD113F847FF847E9FF00FC66803F9A3FF88BE7F6C6FF00A0A7C3BFFC2613FF008BA3FE22F9FDB1BFE829F0EFFF000984FF00E2EBFA5CFF008600F80FFF00444FE11FFE11FA7FFF0019A3FE1803E03FFD113F847FF847E9FF00FC66803F8D9FF8287FFC1477E257FC14FBE35697E3EF8A771A2DC788348D122F0FDBB699622CE116B1CF713A82809CB6FB9979F4C0ED5FDC157F2BFF00F0784FC1FF00097C14FF008297F81F4AF06F85FC3BE11D2EE3E19585DCB67A2E9B0D85BC931D57565323244AAA5CAA22962324228E8057F5414005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400565F8E3C0FA37C4CF06EA9E1DF1169761ADE83ADDAC965A869F7B02CF6F79048A55E3911810CACA48208E735A95F983FF0007217FC16AFE2A7FC11F3FE14CFF00C2B3D03E1FEB9FF0B13FB6FF00B4BFE127B1BBBAF23EC5FD9FE5793F67B9836E7ED726EDDBB3B531B707201F2B7EDE1FF0658D8F8B7C637FAE7ECEFF0011B4FF000CD8DE31923F0BF8B92796D6C98F3B62BE88492F97D82C90BB003991BB78B7C18FF83257E366ADE33823F887F16BE16E83E1D0419A7F0E8BFD5EF5877558A7B7B5419E9B8C8719CE0E30791FF88D5BF6A6FF00A107F67FFF00C11EAFFF00CB3A3FE2356FDA9BFE841FD9FF00FF00047ABFFF002CE803FA13FD80BF602F873FF04D8FD9CB4DF867F0CF4D96CF47B376BABCBCBA712DF6B176E0092EAE24006E91B6A8E0055555550AAA00F6BAFE607FE2356FDA9BFE841FD9FF00FF00047ABFFF002CE8FF0088D5BF6A6FFA107F67FF00FC11EAFF00FCB3A00FD7BFF82A4FFC1BE3E0BFF82B37C72B0F1A7C42F8ABF13F4D8344B15D3F48D0F4A7B25D3B4B8CE0CAD1AC9033192571B9DD9893845FBA8A07D4FF00B08FEC63E15FF827CFECA5E11F845E0B92FAE340F08C12C715CDE946BABC9259A49E59A52AAAA5DE491CF0001900000015FCEEFF00C46ADFB537FD083FB3FF00FE08F57FFE59D7DE1FF06F4FFC1C2DF1A3FE0ACBFB68789FE1CFC46F0C7C2FD1744D17C1575E24827F0DE9D7D6D74F7115F585BAA334F793218CA5D4848080E42FCC0020807EC75145140051457E4B7ED1FF00F077D7C0FF00D9A3F687F1E7C38D5BE1A7C56BFD57E1FF0088B50F0DDE5CDA4761F67B89ACEE64B791E3DD701B6334648DC01C11900F1401FAD3457E31FF00C46CFF00B3FF00FD129F8C5FF7EF4DFF00E4AA3FE2367FD9FF00FE894FC62FFBF7A6FF00F255007ECE515F8C7FF11B3FECFF00FF0044A7E317FDFBD37FF92A8FF88D9FF67FFF00A253F18BFEFDE9BFFC95401F0EFF00C1EADFF294DF00FF00D92AD3BFF4EFAC57F4FD5F87BE31FF0083C03F64FF0088BA9C77DE20FD9FBC79AEDE4510812E350D2347BA952304B040CF3921416638E9963EB5FAB7FF0004F7FDB6BC3FFF000517FD903C23F193C2DA4EB1A1E83E31FB67D96CB55118BB87ECD7B7166FBFCB674E5EDD98618FCAC338390003D9E8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002BCFFE3A7EC9DF0B3F6A0FECBFF8599F0D3E1FFC44FEC3F37FB37FE127F0F5A6AFFD9FE6ECF37C9FB446FE5EFF002A3DDB71BBCB4CE768C7A051401F3FFF00C3A77F659FFA369FD9FF00FF000DE691FF00C8F47FC3A77F659FFA369FD9FF00FF000DE691FF00C8F5F4051401F38F89BFE08FDFB29F8B3C37A869771FB377C0D82DF52B692D2592CBC11A6D9DCC6B22952D14D142B24520072B246CAEA70548201AFC20FD8F3E0C7C3BFF00823FFF00C17375CFD98FE3B7C37F86BF143E16FC41D4ADECFC3BAE78B7C2DA7EA977A7ADDFFC832E9669E2251199C5B5C202B1870D20E23F9BFA6AB8B88ED2DE49A691228A252EEEE76AA28E4927B01EB5FCA7FF00C1CCFF00B50787FF006D3FF82CEF87A3F83DAC58F882F3C27A3691E0FB6D4F4A945C4177AB2DF5CDC0F2A44C890A3DDC716573F344C0671401FD19FF00C3A77F659FFA369FD9FF00FF000DE691FF00C8F5D87C14FD88BE0BFECD7E2AB8D77E1CFC21F85FE00D6EEED1AC27D43C37E15B1D2AEA6B76747685A58224768CBC71B142704C6A719518F50A2800A28A2800AFCCFF008F1FF06A2FECBBFB457C71F19FC41F105DFC505D7BC75AEDF788752169AF411DB8B9BBB87B897CB536E4AA6F91B009240C0C9EB5FA6145007E527FC41C3FB22FFCFEFC5CFF00C28A0FFE45A3FE20E1FD917FE7F7E2E7FE14507FF22D7EADD1401FCF0FFC16E3FE0D5AF02FEC9FFB176A9F153E00DE78CF50D43C085B50F11E93ACDEC77A6EF4C0079B710958E32AF6F8F3194E4347E61E0A00D6BFE08B7FF0432FD8AFFE0ACDFB1C5878E619BE29693E32D166FEC9F16E8F0F8920DB617CAA1BCC8C1B62DE44CA43C64E71F3212CD1B1AFDF0F8C57BE1FD37E1178AAE3C5AD6F1F856DF47BB93596B82042B642173397278DBE587CE78C66BF9CAFF83257C7BAC69DFB777C5AF0BC3E77FC23FAC780BFB52F700F97F6AB5D42D62B7CF6DDB2F2EB19E71BB1DE803EFEFF0088387F645FF9FDF8B9FF0085141FFC8B5FA0BFB10FEC71E11FF827FF00ECBFE18F847E037D5E4F0A784BED5F616D52E56E2E8FDA6EE6BB937BAAA06FDE4EF8C28C2E0738C9F56A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800AFC85FF83AB7F65DFDA4BF693FF850FF00F0CF7A37C40D5FFB17FE120FEDFF00F8463507B4F2BCDFECCFB379DB644DD9F2EE36E738C3F4CF3FAF55E45FB54FEDEDF073F620FEC1FF0085B5F10FC3BE03FF00849FED1FD95FDAB318FEDDE4795E76CC039D9E7459FF007C5007F2D1FF000EBAFF008292FF00D09BFB407FE1412FFF002451FF000EBAFF008292FF00D09BFB407FE1412FFF002457F475FF000FECFD8E7FE8E1BE1DFF00E063FF00F1347FC3FB3F639FFA386F877FF818FF00FC4D007F38371FF0452FF8288FC7345D1F56F873F15F56B5765062D7BC4B125A8248E49B9BA09E84FA62BF503FE085BFF06AFEA7FB22FC6BD0BE337ED01A9687A978ABC3332DF7873C2BA5C86EADB4CBC5398EEEEA7202C92C47E648E30555C23F98C4051F7F7FC3FB3F639FFA386F877FF818FF00FC4D6BFC3EFF0082D7FECA3F157C7BA1F85FC3BF1D7C07ABF883C49A841A5699616F76CD35EDD4F22C50C4836F2CEECAA07A91401F51D15E5BFB5C7EDADF0BBF611F86F63E2EF8B5E2EB1F05F86F52D4A3D1EDAFAEA09A6496EDE29664880891DB2638256C918F90F39C64FD91FF006D6F85DFB777C37BEF177C25F1758F8D3C37A6EA5268F737D6B04D0A4576914533C444A88D911CF13640C7CE39CE7001EA5451450015FCC0FEDFBFF0736FED7DF013F6EEF8D7E05F0CF8E740B3F0DF82FC7BAEE83A54127862C26786D2D7509E0850BB4459888D14166249C64F35FD3F562DD7C36F0EDF5D493CFA068B34D33979247B18999D89C92495C924F393401FC9FF00FC458BFB6C7FD142F0DFFE125A77FF001AA3FE22C5FDB63FE8A1786FFF00092D3BFF008D57F579FF000AB3C31FF42DE83FF82F8BFF0089A3FE1567863FE85BD07FF05F17FF0013401FC84FC4FF00F829FF00EDCFFF000580B59BE1BB789BC7BF10B4DD5A548A7F0EF853408AD6DE60C70A9702CA142F16793E7B328C64F0B91FBB9FF06D57FC11535BFF008259FC12F1178AFE238B35F8AFF121605BCB18245993C3B6316E68ED3CD5255E57772F2952532B1A8276166FD32B0D3EDF4AB38EDED6086DADE11B5228902220F400702A6A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A2B93F8F1F19348FD9D7E0778CFE20F8816F1B41F02E857DE21D485A4624B836D696EF712F96A480CFB236C0240270323AD007595F9C7FF07027FC1107C4DFF0594FF854BFF08E78EB41F05FFC2B8FED8FB47F69594B73F6CFB77D836ECF2C8DBB3EC8D9CF5DE3D0D701FF00118F7EC8BFF3E5F173FF0009D83FF92A8FF88C7BF645FF009F2F8B9FF84EC1FF00C95401F10FFC4107F137FE8BA7813FF04B77FF00C551FF001041FC4DFF00A2E9E04FFC12DDFF00F155F6F7FC463DFB22FF00CF97C5CFFC2760FF00E4AA3FE231EFD917FE7CBE2E7FE13B07FF00255007C43FF1041FC4DFFA2E9E04FF00C12DDFFF00155E8FFB1D7FC19E7F113F664FDAEBE15FC49BEF8CDE0BD52CFE1EF8BF49F12DC5941A45CC72DDC7657B0DCB44AC5B0198465413C026BE97FF0088C7BF645FF9F2F8B9FF0084EC1FFC955D5FC07FF83AEBF65DFDA2BE38F833E1F787ECFE282EBDE3AD76C7C3DA69BBD0608EDC5CDDDC25BC5E630B825537C8B92012064E0F4A00F41FF8385BFE097FE3EFF82B2FEC5FE18F873F0E757F07E8BADE8BE35B5F124F3F892EAE6DAD5EDE2B1BFB7645682099CC85EEA320140301BE604004FF00837A7FE097FE3EFF00824D7EC5FE27F873F11B57F07EB5ADEB5E35BAF12413F86EEAE6E6D52DE5B1B0B754669E085C481ED64240423057E624903EEFA2800A28A2800AFE59FF00E0A0FF00F0457FDBA3E2A7EDF1F1C3C51E11F871E3ABEF09F893C7FAF6A9A2DCDBF896D218AE2CA7D4679607446BA52AAD1B210A541008040E95FD4C57E6E7FC148FFE0E73F827FF0004D6FDA9B52F84BAF785FC75E2FF0010E87676D73A94DA125A1B7B19674F356DD8CD32319044D139C020095467208001F855FF000E1AFF0082857FD12DF885FF00855597FF0025D1FF000E1AFF0082857FD12DF885FF00855597FF0025D7F58DFB3CFC57BDF8E7F04BC33E30D43C29AF781EE7C496497FFD87AD8886A1A7A3E4A2CEB1B32AC8536B15DC4AEEDA70C081E57FF0504FF82A6FC13FF8263782ACB58F8B5E2E8F49B9D5B7FF006568F670B5E6A9AAEDC6E31409CEC5C806472B182402C0900807F31BFF000E1AFF0082857FD12DF885FF00855597FF0025D7EBE7FC1A9FFB06FED0BFB11FFC2F9FF85F1E17F10F86BFE126FF00847FFB0FFB535586FBED3E47F6A7DA36797349B76F9D06738CEE18CE0E3B1F82BFF077FF00EC8BF173C7D6FA1EA47E2678061B999608F55F11E8502E9F962402CD6B7370E8B9C659D1400D9240048FD3BF0A78B34BF1E78634FD6B44D46C757D1F56B74BBB2BEB39D67B7BB85C06492375255958104104820D007F31BFF0712FFC12DFF68CFDA33FE0B19F183C65E03F82DF117C5BE14D63FB17EC3AB697A2CD716B77E5689A7C326C75183B648DD0E3A3211DABFA82A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002B8BFDA3FE0969FF00B4BFECF1E3CF871AB5D5E58695F103C3BA8786EF2E6D36FDA2DE1BCB692DE478F702BBD564246E04640C8238AED28A00FC63FF0088263F67FF00FA2ADF18BFEFE69BFF00C8B5F9CBFF0007077FC1177E08FF00C11F3C11F0FED7C1FE36F885E28F1DF8EAF2E255B4D624B336969A7DBA28965611408DBDA596154F9B042CBE82BFAB6AFE65BFE0F61D37548BFE0A2FF0C6F2649868B3FC38821B563FEACDC26A7A819C0F70925BE7D8AD007D09FB1E7FC19A5F0D7E28FECB3E00F137C46F889F12B47F1BF89343B6D5757D3B4BFB1476BA74B3A097ECEA2481DF746AEA8C4B105D588C0200F49FF88263F67FFF00A2ADF18BFEFE69BFFC8B5FAE9F047E27E87F1AFE0DF857C61E199ADEE3C3BE28D22D755D32480831B5BCD12C91E31C70AC06074C5751401F8AFAFF00FC192BF03A5D0AF574BF8B7F15ADF53681C5A4B7434F9A08E6DA763488B6EACC81B04A8652464023AD7E79FF00C112BFE09EDE05F037FC16BA0F83FF001DF58F14F837E2E7C29F165AEB1E15FECD9E0FEC9D72FB4BB85BCFB34BE6C464293C51A4B13A94DF1EE1C33267FAB4AFE62FFE0EADF8956BFB3D7FC1777C01E3CF054B1AF8ABC33E1AF0FEBD7DF667D922EA56D7F74D10765190C6DE2B4F53B4AF6C0A00FE9D28A28A0028A28A002BF947FF0082377C2D87FE0AF5FF00070CEA3E37F152FF006B6896FAEEABF1375082546749A186E41B384838C46B3CF66BB5860A26C239C57F5715FCABFF00C1BE3F16B45FF8257FFC1783C4DE07F891A843E19B3BC8F59F86B717DA9388E1B5B95BD86480C921002AC92D94681F01732A938524800FEAA2BF8E9FDA63C43E34FF0082F4FF00C16FB52D2742D484D27C42F15C9A0786E598992DF47D12D9A4F2E5DB9FB91DAC525C3AAE3731908E5ABFA70FF82C4FEDE7E1AFD81FFE09EBF11BC69A86B9A7D9EBB79A1DCE9DE16B569D7CFD4F53B889A2B61126774815DC48E541DB1C6EC70066BF0AFF00E0CC4FD9E9BE22FF00C146BC61E3FB8B612D8FC37F08CAB0CA533E4DEDF4A90C583D89B74BC1F4CD007D13FB69FF00C199BE09F867FB22F883C45F0A7E2378FB5BF895E17D2A6D4FEC3AD25A3E9FAFB4285DADE148A2492DDDC2B042D24A37150700961B3FF065B7EDD9AF78F7C11F123E017883509B50B0F06C30F897C30B33977B2B6965315DDBA93D2212B4122A8E8D34BEBC7ED8FC6CF8A3A57C0FF837E2CF1A6BB245168BE11D1EEF59BF795C222C16F0BCB2649E00DA879AFE707FE0C9BF045E5FFF00C1437E29789235FF00897E93F0EA5D3676C7496E752B192319F75B497F2A00FE9968A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002BF3F3FE0E1CFF00823C49FF000561FD946CFF00E114FB2C1F163E1DC936A1E1869DD628F53491545C69F248D8082511C6C8EC4059224C9556723F40E8A00FE4AFF605FF0082E8FED35FF0436D7B52F83BE2BF0CB6B9E1BF0FDD3C73F82FC5B1CD6B75A1C85B73FD9271F342AE4EEC159223B8BAAE58B1FD0AF0BFFC1F01F0EEEF4947D6BE02F8D34FBE38DF0D97882DAF215E067123C5113F3647DC1C0078CE07EB7FED57FB06FC1BFDB8341874EF8B3F0DFC29E398AD51A3B69F51B2537964AC72C20B95C4D0E4F5F2DD735F177887FE0D2AFD8B35AD524B8B6F05F8BB4885C922DAD3C577AD147C93C199E47EF8E58F0077C9201F06FED21FF07BA789B5BD02EAC7E13FC11D2BC3F7D22B2C3AB789B5B6D47CACE40616B0C710DC07233330CF552073F317FC119FFE09D5F18BFE0B6FFF000516B7F8DDF143FB5B56F03697E20875FF0017F8AB5280470EBB3C0CAD1E9B6C368490B7971C6C918090423F84F948DFB87F03BFE0D91FD8BBE066B50EA50FC2387C51A85BFDC7F136AD77AA427927E6B6924FB3BF61F344781EE73F757867C31A6F82B40B3D2746D3AC749D2F4F8C436B67656EB6F6F6D18E8891A00AAA3D0002802F515F35FED2BFF0588FD983F6456BA87C79F1BBC07A66A1659F3F4CB3BF1AA6A5111D9AD6D44B303F5415B7FF0004F5FF00828EFC35FF00829DFC24D7BC71F0AEE35ABCF0DE81E209BC3725CEA3626CDAE6E22B7B6B8678D1896F2F65D460170AD90DF2E002403DE68A28A002BF217FE0BFDFF06D44BFF0516F8812FC60F837A868BE1FF8A335BA43AE695A9136F63E2611A858E612AA9315D08C0425814902C6098F6966FD7AA2803F91AF09FF00C1A97FB6F788BC5B0E9B79F0BB47D06CE490A36AB7FE2FD25ED2219C6F6582E259F6F7F96227DB3C57F447FF000453FF00824AE87FF0489FD945BC1D0EA50788BC67E24BB1AA78A75B8A231C77972102243083F308215C84DDC92F2390A5CA8FB0A8A00F8C3FE0B97FB1E7C78FDBF3F63A97E11FC13D73E1FF00866DFC5972ABE2BD47C4BA9DEDA48D63195912D6DC5B5B4DBBCD900F319CA8091ECC389494F3EFF83783FE08C1AF7FC1207E0778EADBC75AB78575EF881E3CD5E29AEEEFC3F2CF359C3616D195B6803CF144ECC1E5B876FDD81FBC51CEDCD7E885140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051457E107FC1EEBF12FC53E0CF0B7ECEDA5E8BE20D7F49D135E3E264D5ACECAFA682D75128349F284E88C164DA1E5DA1C1C6F7C753401FAB5FB48FFC158FF66BFD91BED11FC41F8D5F0FF42BEB504CBA726A697DA9201FF4E96FE64FFF008E735F9FDFB4A7FC1E79FB3BFC344B9B7F871E0DF1F7C4ED42352619A48A3D0F4D98F61E6CDBE75F726DB81EBD2BF9CDFD99FC0FF0D7E207C448F4FF008A1E3ED73E1CF87DF693AAE9BE19FEDE65E7E60D10B885978E8577F7E3D7F6CBFE09D5FF00048EFF008257FC55FB0BC9FB4137C59D66F701749F11F893FE1133337F763B3DB6D75BBD4095BA71EB401F3D7ED25FF0793FED35F153ED16BE01D0FE1FFC2CB190110CF6F60DAC6A5113DCCB744C0D8E31FE8E3BE73D07835CF833FE0A2FFF00056C3FE9767FB427C44D13545E05E1B9D37C39206FEE890C360339E718C8C7602BFA92FD9B3FE09BBFB3DFECAD676F37C34F843F0EFC37304568F52B3D1E092FA55EAA4DDB8699C7704B9EB9EF5EE5401FCBF7ECE9FF0006667ED25F12E486E3E2078A3E1EFC33B1700CB11BB9359D46327B08A002038FFAF81CF4C8E6BF73FF00E08D9FF04ACD3BFE0907FB2A6A5F0CF4FF00195EF8E9F58F114FE24BBD4EE34E5D3C79F2DADADB148E15924DA816D548CBB1CB1E7A57D6545001451450014515F07FEDFDFF000717FECE9FF04E1FDA2EF3E16F8F26F19EA1E2AD36CADEF6FA3D0B4B8AF21B2F3D7CC8E2919A642243194936E08DB2A1CF38001F78515C6FECF7F1A2DBF68AF829E1AF1CD9687E23F0E58F8A6C9350B5D3F5EB45B4D46185F2633344AEFE5974DAE14B6E0AE37056CA8E3FF6CEFDBFFE0FFF00C13E7E1E45E26F8BDE3AD27C1FA75D33476714DBE7BCD45D7195B7B6895A6948C8C944217702C40E6803D8A8AFCF5F835FF07477EC63F19BC7D6FE1D8FE255F786EE6F6510DB5D788344BAB0B1958E71BAE0A98E21C7DE98A2F239CF15FA09617F06AB630DD5ACD0DCDADCC6B2C3344E1E395186559587041041047041A009A8A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A0028A28A002B3BC55E10D27C77A1CDA5EB9A5E9DACE9B7236CD697D6C97104A3D191C153F88AD1A2803E2DFDA27FE0DE5FD8EFF69869E7D67E08F86743D426CB0BDF0BB4BA0C88E7ABECB478E276FF00AE88C39CE33CD7C17FB447FC1921F0E7C41E75C7C2BF8CDE2FF0BC8CC5D2D3C4BA6C1AC4383FC02487ECCCA076255CE0007279AFDC0D4B53B7D1AC65BABCB886D6D615DD24D3388E38C7A963C01F5AF94FF68BFF0082E8FEC93FB2CB5D43E2BF8E9E0792FECF2B25868972DAE5DA3FF71A3B259591B38E1F6E3A9C0E6803F13E5FF837E3FE0A3DFF0004E59E6BAF81DF10AE359D32DA4322DBF827C6D2E9DE7A9C9265B2BA3044E7B94FDE738C6E3445FF000703FF00C147BFE09CB3C36BF1C7E1EDC6B3A65B48236B8F1B78265D3BCF53800457B6A2089CF60FFBCE739DC6BEB9FDA33FE0F5DF835E0B6BAB5F863F0B3C77E3BB98B2B1DD6B1730685652B76652BF6894AFB34684E31C75AF8A3E257FC1D5BFB68FED9DAC5DF863E10F82FC3FE1E92F54A4567E16F0B4DE20D58C6DC10DE7F9C8F9CE32B02FD2803EBCFD9CFF00E0F6DF86FE22F2ADFE2B7C1BF17F8565276B5E786B51835984FF00B463985B3A0F500C87EBD2BF56BF60CFF8283FC2DFF82947C14B8F1F7C25D72EF5CF0FD8EA7268D78D75A74F63359DEC714333C2C92A2EE223B885B721643BF01890C07F319E10FF00837CFF006EAFF8280F8FAE3C5DE26F86FF00F08CDD6AE43DD6ABE2B92CF400CDDB75A46A2707DC41F53D2BF7EFFE0803FF0004B8F177FC124FF62AD6BE1D78DBC45E1CF126BDAF78B2E7C4D2CDA1F9CD676CB2D9D95B0855E6447720DA336E28B90E0638A00FB8A8A28A002BF93DFF008263FC2787FE0B4FFF0007106A9E26F1705D63C2F71E23D4FC7FAADBCCA248E7D3ED6706CED48E8D16F6B38483D63C8E7BFF005855FCB1FF00C1B47F1174BFF827AFFC1767C49F0FFC797B6BA1DC6AD65AD7C35F3F507F2563D423BE8248E32C7015E492C3CA507EF3C8AA3961401FD4E57F1EBFB7CFC51F1FFF00C174FF00E0B59A9E81E1AB893506F12789DFC23E0DB7965CDAE99A55BCAE8B31007CB1F9692DD4B804E5A4C6EC0AFEA13FE0AAFF00B62E97FB07FF00C13F7E287C48D4350B6B1BED2F43B8B6D0D25936B5E6AB346D159C283AB1333293B412A8AEC785247F3F7FF066A7ECF3FF000B37FE0A6FAFF8EAE2DD64B3F867E11BA9E094AE4C57B7AE96B181E99B76BCE7DB18E49001EB9FB677FC199D7BF033F646D73C63F0FBE2D5F78D7C71E11D2E6D52F746BCD0D6D2DF5A5850C92476A525778A4DAADB15FCC0EDB57299C8F72FF8334BFE0A15E23F8CBF083C75F017C55A94DAA2FC3686DF57F0B4B712179ADF4E99DA39AD013CF950CBE532039DA2E1946155147ECE7C58F1D695F0BFE16789BC4DAEB429A1F8774ABAD4F506971E5ADBC10BC9296CF1B762B673C62BF9B5FF008327BC2F7B77FF00051AF89DAD463FE25DA7FC379EC673CF12CFA9E9CF1F6C7DDB797A9CFA679C007F4D54514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450014514500145145001451450015F8FBFF000764FF00C14EFE36FF00C13C3C39F04B4DF83BE337F05AFC403AF7F6CDCC1A7DB5C5CCCB69FD9BE4AC6F346E62C7DAA5C94DAC7239E2BF60ABC07F6F4FF8260FC12FF8298786F45D37E327838789C7864DC368F751EA1736373A634FE579C6378244CEFF00262C87DCA760E2803F911F0EFC49F88DFF000530F89EBA4FC5AFDA56D749DECB2477FF0012FC47AA49A6A9CE088FCB86E1222BE8446BCF07AE3F563F611FF8345BE0BFC7BD16DF5AD63F6A9D2FE2658ED5927B7F86C6C9A2881C71F6A792E33D71CC2A47A57AC7ED25FF00064CFC2FF14FDA2EBE14FC5DF18783EE18974B2F10D8C3AD5A8FF615E3FB3C88BEEDE611EF5F07FC6BFF008350BF6CCFD9735B3ADF8057C3BE3C360E5EDAF7C23E21FB0EA112FF007B65CF90C1BFD98D9CFA66803F703F675FF836B7F635FD9C7CB9ADBE0FE9BE30D45400D79E2EBA9B5AF331D3304AC6D87D56104F7CF18FB47C01F0D7C39F0A3C3B0E8FE16F0FE89E1AD26DC622B2D2AC62B3B78FB7CB1C6AAA3F015FC9C587FC14FBFE0A41FF0004BEBA86D3C5DE22F8CBA1E9D632F93F67F883A2CBA9D9CE3B4693DF44E4A7403CA946070A40AFA8BF675FF83DA7E2878605B5BFC52F83FE0DF1742A76CB79E1EBF9F45B82BFDE2928B84661D703603FECF5A00FE9028AFCB1FD9DFF00E0EFCFD927E30AC50F8AAE3C75F0B6F598237F6E688D796A58FF00765B269DB6F3D5D131CF18E6BF43FF0066FF00DAA3E1CFED81F0F5BC57F0BFC69E1FF1D78763BA6B196FB48BB5B88E0B854491A1931CC7204963628C0300EA71C8A00EFE8A28A002BF147FE0E1AFF8369FC45FB667C58BCF8E7F00134F6F1E6A71A9F12F85EE6E52CD75B9A350A9776B2B911A5C155557491911F6870CADBB7FED757E20FED63FF0794FFC32FF00ED4FF12FE19FFC338FF6E7FC2BBF15EA9E18FED2FF0084FF00ECBFDA1F62BB96DBCFF2BFB35FCBDFE56ED9BDB6EEC6E6C64807E5E5F7FC10ABF6FEF8EFE21D3743F107C2FF0088FAA7D9A4315BCBE20D7616B3B1070ACC259AE0A2AE00E54F20719E2BFA1FFF00820CFF00C1202DFF00E0911FB28DE687AAEA163AE7C48F1B5D47A9F8AB51B353F66578D0AC16703300CF0C01E4C330059E695B0A182AFE71FF00C4739FF56BBFF9923FFBD747FC4739FF0056BBFF009923FF00BD7401FA53FF0005DEF80BF1FBF6B5FD88F50F84FF0000F4FD0DAF7C792FD8FC49A9EA5ABAD87D8F4C5DACF0460A92ED70708C7A08D650797047927FC1B55FF0470F17FF00C128FE0A7C42BAF8989A20F881E3ED5A0575D32EBED715B69D6B1B790BE6607CCD2CF70CC00C60479248C0F8C7FE239CFF00AB5DFF00CC91FF00DEBA3FE239CFFAB5DFFCC91FFDEBA00FDFEA2BF007FE239CFF00AB5DFF00CC91FF00DEBAFD7EFF00825C7EDCFF00F0F28FD84FC0BF1ABFE117FF00842FFE134FB7FF00C49BFB4BFB4BEC7F65D42E6CBFD7F9516FDDF67DFF00EAD71BF6F38DC403E80A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28A2800A28AF07FF0082907FC142BC0DFF0004C7FD95B5AF8A5E3A9269AD6C596CF4CD2EDDD56EB5CBF90318AD62DDC02DB59998E42223B60EDC100F78ACFD5BC57A5E83751417DA969F6734FF00EAE39EE1236939C70188279E38AFE4BBE3C7FC15A7F6E0FF0082D7FC64BEF0FF008066F8811E92EED25BF83BE1D477305AD8DB1242FDAE5870F28C70D25C3ECDC32AA830A3021FF83637F6EEF1327F683FC0FBB964BD26677BAF17E851CCECC724BAC97C1C31392770CD007F5F5A869F6FAB594B6B75043736F3A949229503A48A7A82A7820FA1AF943F692FF82147EC95FB567DA25F157C0EF05DBEA1744BC9A86836EDA1DE33FF007DA4B3688C8DFEFEE07B835FCD46ADFB2A7FC1413FE08D36F1F8AE1D17E317C2FD1F48669E7BED1351FED1D12019C9375F65926B4F2C9E7138DAC7D6BF68FF00E0DEBFF838D7FE1E47AB2FC22F8BB0E97A37C62B5B47B8D3351B451059F8BA28C16902C5D22BA441BD9149575591D420528003CD3F692FF83277E13F8BBED175F0AFE2C78D3C1373212E967AF59C1ADD9AFF00B0A53ECF2AAFBB34847BF4AFB3BFE0809FF04BBF18FF00C124FF00647F187C35F1A6BDE1BF125E6ADE39BBF1158DF68CD3794F692D869F6EA2459510A4BBED64CA8DCA015218E481F73514005145140057C41F163FE0DC3FD8C7E38FC53F1378DBC53F06FF00B53C4DE30D56EB5BD5EF3FE12DD720FB5DE5CCCF34F2F971DEAC69BA4766DA8AAA338000C0AFB7E8A00F803FE2171FD84FFE886FFE5E7E20FF00E4EA3FE2171FD84FFE886FFE5E7E20FF00E4EAFBFE8A00FC37FF0082E57FC1AFFF0006BC07FB0DEBBF103F66EF05DDF847C61F0EA2975AD474D4D66FF538FC41A6A2E6E100BB9E5293428A654F2C8DE16442AECC85303FE080FF00F04E1FD83FFE0ACDFB1C9D635CF8176767F13FC0B347A4F8BED2DFC63E2048E69194982FA3517D858EE151CEDE36C914CA06D5527F6E7E3E7C48F0CFC1FF00823E2EF14F8CEE6D2D3C27A0691737DABCB72C16216C9133480E78E5410077240EA6BF9CDFF832675BD620FF0082817C55D361DFFF0008FDD7C3D7B9BDC7DDFB547A9592DBE79EBB25BAC71EBD3B807EB0FF00C42E3FB09FFD10DFFCBCFC41FF00C9D5F5FF00ECB9FB2E7813F62DF813A1FC33F867A1FF00C237E09F0D7DA3FB374DFB6DC5E7D9BCFB896E65FDEDC4924ADBA69A46F99CE3760600007A051400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140057F383FF0007B87C79D4754FDA9BE0EFC31135C2693A1F8565F143421888A69EF2EE6B60C477645B16009E8246C7535FD1F57F3D3FF07B6FECABAA27C41F83DF1B6D2CE69F479F4C9BC15A9DCAA129693452C97968AC71C79827BCC73FF2C5BF100FD97FF82677EC05E0EFF826EFEC89E14F86FE14D2ACECEEECEC61975FD423880B8D6F5231AFDA2EA67E4B167DC14124220545F95457BFD7C3FF00F0455FF82CC7C39FF829DFECD9E1B8D7C45A6E9FF17347D3A1B5F13786AEEE963BE7B98D1564BB8118EE9ADE461BC3AEED9BC2390C39FB828023BAB58AFAD648278E39A1994A491BA8657523041078208E306BF94FFF0082DA7C0DD17FE08B7FF05DFF000A78BBE16DB7FC23BA1B3E93F1234DD32CB090E9E1AF268EE6D63507021792D27FDDF0A126D806C0057F511F1ABE3B782FF670F8797FE2CF1F78A342F07F86F4C4325CEA3AB5E25AC098EC1988DCC7A055CB3120004902BF964FDB3BE399FF0083897FE0BE3E10D3FC0BA75FCDE0DD4EFB4FF0AE906E632930D0ED2492E2F2F64439D8A55EF670A40210AA91BF20807F58F45145001451450015FCB57FC141BFE0A39FF0500F03FEDEFF001BF45F0678B3E385B783F47F1FEBD63A14361A1CB25AC56116A33A5BAC4C2021A3112A05209C8C1C9AFEA56B16EBE24F876C6EA4827D7F4586685CA491BDF44AC8C0E0820B641078C1A00FE497FE1E8BFF000525FF00A1CBF680FF00C27E5FFE47A3FE1E8BFF000525FF00A1CBF680FF00C27E5FFE47AFEB5BFE169F863FE863D07FF06117FF001547FC2D3F0C7FD0C7A0FF00E0C22FFE2A803F917D5BE0BFFC1453FE0AB7A9DA7877C41A3FED0DE3ED36E2649521F1025E586810BE7E5958DC795668473863838071D2BFA06FF837FBFE08AD0FFC121FF67FD61FC47A8586BBF157C7EF04FE22BCB2DCD69611421FC8B2B766019950C9233BE177BB74C2257DC5FF000B4FC31FF431E83FF8308BFF008AABFA278AB4BF1379BFD9BA9586A1E4E3CCFB35C24BE5E738CED2719C1EBE86802FD15C9F89BE3DF817C17ADCDA66B1E34F09E93A95B6DF3AD2F757B7B79E2DCA197723B86195208C8E4107BD75940051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005145140051451400514514005703FB4FFECC7E09FDB1FE04F88BE1BFC44D0EDFC41E11F145B7D9EF6D2525586086496371CC72C6E15D1D70559411D2BBEAF903FE0AB7FF0005ABF859FF00047CFF00840BFE166681F1035CFF008589FDA1FD9BFF0008C58DA5D791F62FB2F9BE77DA2E60DB9FB5C7B76EECED7CEDC0C807E1F7EDE3FF000685FED01FB3AF8CEEB5AF8197D6BF16BC290CFE7D8C49791699E22D3C06254491C8C914AC836FEF2190339048893815F3AEADFB357FC14AFC03770E95FF0008DFED8D1AC64C51AE9CDAF5D5BA61B1C3C0CD185CF7CE08E7A735FB19FF0011AB7ECB3FF420FED01FF823D23FF96747FC46ADFB2CFF00D083FB407FE08F48FF00E59D007E4DFC3AFF0082007EDEDFB7978D6C67F19784FC5D61192D1B6BBF11F5E688592EEE72933C974413CE1226CF5E9CD7EF5FFC1147FE082BE01FF8243785AFB586D417C6FF00163C436FF66D53C4B2DB7931DADBE558DA59C64931C25954B3125E465527002A2FCF1FF11AB7ECB3FF00420FED01FF00823D23FF009675D87ECF5FF0775FECDBFB4A7C7DF03FC39D0BC13F1C2D35BF1F7882C3C37A7CF7FA3E971DAC37179731DBC4F2B26A2EEB187914B1546200385278201FA9D451450014515E45FB54FEDEDF073F620FEC1FF85B5F10FC3BE03FF849FED1FD95FDAB318FEDDE4795E76CC039D9E7459FF7C5007AED7F303FB7EFFC1B25FB5F7C7BFDBBBE35F8EBC33E06D02F3C37E34F1EEBBAF6953C9E27B085E6B4BA,
	0x3E4A2F5DB1E2E833B47619D6F493B45AE2D82FE9E3F1D4D4A529388064C031AE,
	0,
	'__ResourceCleanup_jpg.swr');

	SET @DeletedLabelResourceID_JPG = @@IDENTITY
END
ELSE
BEGIN
	SELECT @DeletedLabelResourceID_JPG = ResourceID FROM [Resource] WHERE [Filename] = '__ResourceCleanup_jpg.swr'
END

-- insert the Deleted image (epl format)
SELECT @OldCount = COUNT(*) FROM [Resource] WHERE [Filename] = '__ResourceCleanup_epl.swr'
IF (@OldCount = 0)
BEGIN
	
	INSERT INTO [Resource] ([Data], [Checksum], [Compressed], [Filename])
	VALUES(0x4E0D0A5A540D0A4431350D0A574E0D0A53340D0A52382C300D0A4131302C3130302C302C322C332C332C4E2C2254686973207368697070696E67206C6162656C220D0A4131302C3138302C302C322C332C332C4E2C22686173206265656E20707572676564206279220D0A4131302C3236302C302C322C332C332C4E2C2253686970576F726B7320616E64206973206E6F20220D0A4131302C3334302C302C322C332C332C4E2C226C6F6E67657220617661696C61626C652E220D0A50310D0A,
	0x51EE93BACEE02C78C65800FFC682C7FAF02DFFCD77E70CBEE9C7AC1AA3B472DB,
	0,
	'__ResourceCleanup_epl.swr');
	
	SET @DeletedLabelResourceID_EPL = @@IDENTITY
END
ELSE
BEGIN
	-- we've run it once, so just locate the resource id we are redirecting to
	SELECT @DeletedLabelResourceID_EPL = ResourceID FROM [Resource] WHERE [Filename] = '__ResourceCleanup_epl.swr'
END

-- insert the Deleted image (zpl format)
SELECT @OldCount = COUNT(*) FROM [Resource] WHERE [Filename] = '__ResourceCleanup_zpl.swr'
IF (@OldCount = 0)
BEGIN
	
	INSERT INTO [Resource] ([Data], [Checksum], [Compressed], [Filename])
	VALUES(0x5E58410A5E58410A5E464F34302C38355E41514E2C38302C34305E464454686973207368697070696E67206C6162656C20686173206265656E207075726765642062795E46530A5E464F34302C3137305E41514E2C38302C34305E464453686970576F726B7320616E64206973206E6F206C6F6E67657220617661696C61626C655E46530A5E585A0A,
	0xD768A081FF870E167D538EA2F98DA8BFE1D7994F7FBBEDF44D149CB73421D7B8,
	0,
	'__ResourceCleanup_zpl.swr');
	
	SET @DeletedLabelResourceID_ZPL = @@IDENTITY
END
ELSE
BEGIN
	-- we've run it once, so just locate the resource id we are redirecting to
	SELECT @DeletedLabelResourceID_ZPL = ResourceID FROM [Resource] WHERE [Filename] = '__ResourceCleanup_zpl.swr'
END

CREATE TABLE #ResourceIDsToIgnore
(
	ResourceID bigint
)
INSERT INTO #ResourceIDsToIgnore ( ResourceID ) VALUES  (@DeletedLabelResourceID_GIF )
INSERT INTO #ResourceIDsToIgnore ( ResourceID ) VALUES  (@DeletedLabelResourceID_JPG )
INSERT INTO #ResourceIDsToIgnore ( ResourceID ) VALUES  (@DeletedLabelResourceID_PNG )
INSERT INTO #ResourceIDsToIgnore ( ResourceID ) VALUES  (@DeletedLabelResourceID_EPL )
INSERT INTO #ResourceIDsToIgnore ( ResourceID ) VALUES  (@DeletedLabelResourceID_ZPL )

-- create temp tables
CREATE TABLE #LabelsToCleanUp 
( 
	ObjectReferenceID bigint,
	ResourceID bigint,
	ImageFormat nvarchar(5)
)

-- find all of the UPS labels we want to wipe out
INSERT INTO #LabelsToCleanUp
	SELECT 
		[ObjectReference].ObjectReferenceID AS ObjectReferenceID, 
		[ObjectReference].ObjectID AS ResourceID, 
		CASE 
			WHEN ISNULL([Shipment].ThermalType, -1) = 0 THEN 'EPL'
			WHEN ISNULL([Shipment].ThermalType, -1) = 1 THEN 'ZPL'
			ELSE 'GIF'
		END as ImageFormat		
	FROM [UpsPackage]
		INNER JOIN [Shipment] ON [UpsPackage].ShipmentID = [Shipment].ShipmentID
		INNER JOIN [ObjectReference] ON [UpsPackage].UpsPackageID = [ObjectReference].ConsumerID			
	WHERE 
		[Shipment].ProcessedDate < @earliestRetentionDateInUtc
		AND [Shipment].Processed = 1
		AND [Shipment].ShipmentType = 0 --UPS
		AND [ObjectReference].ObjectID NOT IN (SELECT resourceid FROM #ResourceIDsToIgnore)

-- find all of the fedex labels we want to wipe out
INSERT INTO #LabelsToCleanUp		
	SELECT 
		[ObjectReference].ObjectReferenceID AS ObjectReferenceID, 
		[ObjectReference].ObjectID AS ResourceID, 		
		CASE 
			WHEN ISNULL([Shipment].ThermalType, -1) = 0 THEN 'EPL'
			WHEN ISNULL([Shipment].ThermalType, -1) = 1 THEN 'ZPL'
			ELSE 'PNG'
		END as ImageFormat
	FROM [FedexPackage]
		INNER JOIN [Shipment] ON [FedexPackage].ShipmentID = [Shipment].ShipmentID
		INNER JOIN [ObjectReference] ON [FedexPackage].FedexPackageID = [ObjectReference].ConsumerID
	WHERE 
		[Shipment].ProcessedDate < @earliestRetentionDateInUtc	
		AND [Shipment].Processed = 1
		AND [Shipment].ShipmentType = 6	-- FedEx
		AND [ObjectReference].ObjectID NOT IN (SELECT resourceid FROM #ResourceIDsToIgnore)
	
-- find all of the onTrac labels we want to wipe out
INSERT INTO #LabelsToCleanUp		
	SELECT 
		[ObjectReference].ObjectReferenceID AS ObjectReferenceID, 
		[ObjectReference].ObjectID AS ResourceID, 
		CASE 
			WHEN ISNULL(Shipment.ThermalType, -1) = 0 THEN 'EPL'
			WHEN ISNULL(Shipment.ThermalType, -1) = 1 THEN 'ZPL'
			ELSE 'GIF'
		END as ImageFormat
	FROM OnTracShipment
		INNER JOIN Shipment ON OnTracShipment.ShipmentID = Shipment.ShipmentID
		INNER JOIN [ObjectReference] ON Shipment.ShipmentID = [ObjectReference].ConsumerID		
		INNER JOIN [Resource] ON [Resource].ResourceID = [ObjectReference].ObjectID
	where 
		Shipment.Processed = 1
		AND Shipment.ShipmentType = 11	-- OnTrac
		AND Shipment.ProcessedDate < @earliestRetentionDateInUtc	
		AND [ObjectReference].ObjectID NOT IN (SELECT resourceid FROM #ResourceIDsToIgnore)
		
-- Endicia, Express1, & Stamps labels
INSERT INTO #LabelsToCleanUp		
	SELECT 
		[ObjectReference].ObjectReferenceID AS ObjectReferenceID, 
		[ObjectReference].ObjectID AS ResourceID, 		
		CASE 
			WHEN ISNULL([Shipment].ThermalType, -1) = 0 THEN 'EPL'
			WHEN ISNULL([Shipment].ThermalType, -1) = 1 THEN 'ZPL'
			ELSE 'PNG'
		END as ImageFormat
	FROM [PostalShipment]
		INNER JOIN [Shipment] ON [PostalShipment].ShipmentID = [Shipment].ShipmentID		
		INNER JOIN [ObjectReference] ON [PostalShipment].ShipmentID = [ObjectReference].ConsumerID		
	WHERE 
		[Shipment].ProcessedDate < @earliestRetentionDateInUtc
		AND [Shipment].Processed = 1
		AND [Shipment].ShipmentType in (2,9,3,4) -- endicia, express1, stamps, w/o postage
		AND [ObjectReference].ObjectID NOT IN (SELECT resourceid FROM #ResourceIDsToIgnore)

-- find all of the iParcel labels we want to wipe out
INSERT INTO #LabelsToCleanUp		
	SELECT 
		[ObjectReference].ObjectReferenceID AS ObjectReferenceID, 
		[ObjectReference].ObjectID AS ResourceID, 		
		CASE 
			WHEN ISNULL([Shipment].ThermalType, -1) = 0 THEN 'EPL'
			WHEN ISNULL([Shipment].ThermalType, -1) = 1 THEN 'ZPL'
			ELSE 'JPG'
		END as ImageFormat
	FROM iParcelShipment i
		INNER JOIN Shipment ON i.ShipmentID = Shipment.ShipmentID
		INNER JOIN [ObjectReference] ON Shipment.ShipmentID = [ObjectReference].ConsumerID		
		INNER JOIN [Resource] ON [Resource].ResourceID = [ObjectReference].ObjectID
	where 
		Shipment.Processed = 1
		AND Shipment.ShipmentType = 12	-- iParcel
		AND Shipment.ProcessedDate < @earliestRetentionDateInUtc	
		AND [ObjectReference].ObjectID NOT IN (SELECT resourceid FROM #ResourceIDsToIgnore)

CREATE INDEX IX_ResourceWorking on #LabelsToCleanUp (ObjectReferenceID, ResourceID)		

-- see if there's any actual work to do
SELECT @OldCount = COUNT(*) FROM #LabelsToCleanUp;
IF @OldCount > 0
BEGIN

	DECLARE @currentBatch TABLE 
	( 
		ObjectReferenceID bigint,
		ResourceID bigint,
		ImageFormat nvarchar(5)
	)

	WHILE @latestExecutionTimeInUtc IS NULL OR @latestExecutionTimeInUtc > GetUtcDate()
	BEGIN
	

		INSERT INTO @currentBatch
			SELECT TOP (@batchSize) * 
			FROM #LabelsToCleanUp	

        SET @batchSize = @@ROWCOUNT;
        IF @batchSize = 0
            BREAK;
	    
	    DECLARE @totalSeconds INT = DATEDIFF(SECOND, @startTime, GETUTCDATE()) + 1;

        -- stop if the batch isn't expected to complete in time
        IF (
            @latestExecutionTimeInUtc IS NOT NULL AND
            @batchTotal > 0 AND
            DATEADD(SECOND, @totalSeconds * @batchSize / @batchTotal, GETUTCDATE()) > @latestExecutionTimeInUtc
        )
            BREAK;
	    
        BEGIN TRANSACTION	
		
        -- adjust the old reference to point to the new 'deleted' image resource, by image format			
		UPDATE ObjectReference 
		SET ObjectReference.ObjectID = 
		(
			CASE batch.ImageFormat
				WHEN 'PNG' THEN @DeletedLabelResourceID_PNG
				WHEN 'GIF' THEN @DeletedLabelResourceID_GIF
				WHEN 'JPG' THEN @DeletedLabelResourceID_JPG
				WHEN 'EPL' THEN @DeletedLabelResourceID_EPL
				ELSE @DeletedLabelResourceID_ZPL
			END
		)					
		FROM @currentBatch AS batch
		INNER JOIN ObjectReference
			ON batch.ObjectReferenceID = ObjectReference.ObjectReferenceID

		
		-- delete from our temp table
		DELETE labelsToCleanup
		FROM #LabelsToCleanUp AS labelsToCleanup 
		INNER JOIN @currentBatch AS batch
			ON labelsToCleanup.ResourceID = batch.ResourceID AND labelsToCleanup.ObjectReferenceID = batch.ObjectReferenceID
			
	COMMIT TRANSACTION
					
		--grab the next batch before ending loop
		DELETE @currentBatch	
		
                -- update batch total and adjust batch size to an amount expected to complete in 10 seconds
        SET @batchTotal = @batchTotal + @batchSize;
        SET @batchSize = @batchTotal / @totalSeconds * 10;
	END
END

DROP TABLE #LabelsToCleanUp
DROP TABLE #ResourceIDsToIgnore
";
        }
    }
}
