///////////////////////////////////////////////////////////////////////////////
//
// This file was automatically generated by RANOREX.
// Your custom recording code should go in this file.
// The designer will only add methods to this file, so your custom code won't be overwritten.
// http://www.ranorex.com
//
///////////////////////////////////////////////////////////////////////////////

using System;
using System.IO;
using System.ComponentModel;
using System.Windows.Forms;
using System.Net;
using System.Collections.Generic;
using System.Text;
using System.Text.RegularExpressions;
using System.Drawing;
using System.Threading;
using WinForms = System.Windows.Forms;

using Ranorex;
using Ranorex.Core;
using Ranorex.Core.Repository;
using Ranorex.Core.Testing;

namespace SmokeTest
{
    public partial class VerifyInstallationOfBullZipPDFCreator
    {
        /// <summary>
        /// This method gets called right after the recording has been started.
        /// It can be used to execute recording specific initialization code.
        /// </summary>
        private void Init()
        {
            // Your recording specific initialization code goes here.
        }

        public void CheckIfExists()
        {
        	try
        	{
        		//	Checks if BullZip Printer GUI exists
	        	if (!System.IO.File.Exists(@"C:\Program Files\Bullzip\PDF Printer\gui.exe"))
	        	{
	        		//	Installs BullZip Printer if the BullZip Printer GUI does not exist
					InstallBullZip();
	        	}
	        	else
	        	{
	        		//	Skips BullZip Printer installation if the BullZip Printer GUI exists
	        		TestSuite.Current.GetTestContainer("InstallBullZipPDFCreator").Checked = false;
	        	}
        	}
        	catch(Exception e)
        	{
        		Report.Failure("The process failed unexpectedly");	
				Report.Log(ReportLevel.Info, "CheckIfExists()", e.Message);        	        		        		
        		Environment.Exit(0);        		
        	}
        }
        
 
        public void InstallBullZip()
        {
        	//	Path for BullZip Printer Installer
        	string BullZipInstaller = @"\\intfs01\Development\Testing\BullZipPDFCreator\Setup_BullzipPDFPrinter.exe";
        	
			try
			{	
        		DisappearingWindow window = new DisappearingWindow();
     			window.ShowDialog();
     			
        		if (window.DialogResult==DialogResult.OK)
        		{
	        		Report.Log(ReportLevel.Info, "InstallBullZip()", "Launching BullZip PDF Creator Setup\n");
	        		Thread.Sleep(1500);        		
	        		System.Diagnostics.Process.Start(BullZipInstaller);
        		}
       			else
       			{
        			MessageBox.Show("BullZip Printer must be installed. Ranorex will now exit!","BullZip Installation",MessageBoxButtons.OK,MessageBoxIcon.Error);
        			Report.Failure("The process failed unexpectedly");	
					Report.Log(ReportLevel.Info, "InstallBullZip()", "BullZip Printer installation was cancelled!");        	        		        							
	        		Environment.Exit(0);	       
        		}
			}
			catch(Exception e)
        	{
        		Report.Failure("The process failed unexpectedly");	
				Report.Log(ReportLevel.Info, "InstallBullZip()", e.Message);        	        		        		
        		Environment.Exit(0);
        	}        	
        }
    }
}

