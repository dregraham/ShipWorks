def BUILD_FOLDER = env.BRANCH_NAME.replaceAll('/', '-').replaceAll(' ', '-')

pipeline {
	agent {
		node {
			label 'windows'
			customWorkspace "d:/jenkins-builds/SOI_${BUILD_FOLDER}"
		}
	}
	options {
    	disableConcurrentBuilds()
  	}
	stages {
		stage('Build') {
			steps {
				echo "Build on ${NODE_NAME}"
				bat 'bundle exec rake build:public_installer[6.4.5]'
				archiveArtifacts artifacts: 'Artifacts/Distribute/*.*,Artifacts/Logs/*.*', fingerprint: true
			}
		}
	}
}